<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yale Clinical Trials - Virtual Escape Room</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 text-gray-800 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-3xl mx-auto">
        <header class="text-center mb-10">
            <img src="logo.png" alt="Yale Logo" class="mx-auto mb-4 rounded h-16">
            <h1 class="text-4xl font-bold yale-blue-text">Clinical Trials Virtual Escape Room</h1>
            <p class="text-lg yale-gray-text mt-2">The Decker Protein Discovery Challenge</p>
        </header>

        <div id="intro-section" class="puzzle-container visible text-center">
            <h2 class="text-2xl font-semibold yale-blue-text mb-4">Welcome, Researchers!</h2>
            <p class="mb-4">You've been selected for a critical mission: to fast-track the "Decker Protein" clinical trial. This revolutionary discovery at Yale could change medicine forever, but first, you must prove your team's expertise by navigating a series of challenges.</p>
            <p class="mb-6">Solve each puzzle to unlock the next. Your critical thinking, knowledge of clinical trial protocols, and teamwork are paramount. The fate of the Decker Protein trial rests in your hands!</p>
            <button id="start-game-button" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md transition-transform transform hover:scale-105">
                Begin the Challenge!
            </button>
        </div>

        <div id="puzzle1-biometric" class="puzzle-container hidden">
            <h2 class="text-2xl font-semibold yale-blue-text mb-1">Puzzle 1: Biometric Code Entry</h2>
            <p class="text-sm yale-gray-text mb-4">Answer the questions correctly to unlock the access code for the Decker Protein Database.</p>
            
            <div id="p1-lights" class="flex justify-center space-x-2 mb-6">
                <span class="green-light" id="p1-light-0"></span>
                <span class="green-light" id="p1-light-1"></span>
                <span class="green-light" id="p1-light-2"></span>
                <span class="green-light" id="p1-light-3"></span>
                <span class="green-light" id="p1-light-4"></span>
                <span class="green-light" id="p1-light-5"></span>
            </div>

            <div id="p1-questions-container">
                </div>
            <div id="p1-feedback" class="feedback-message mt-4"></div>
            
            <div id="p1-final-code-entry" class="hidden mt-6">
                <p class="font-semibold mb-2 text-center">Enter the 6-character activation code to access the Decker Protein database.</p>
                <input type="text" id="p1-code-input" class="border border-gray-300 p-3 rounded-lg w-full text-center text-xl tracking-widest" placeholder="ENTER CODE">
                <div class="mt-3 flex gap-2">
                    <button id="p1-submit-code" class="flex-1 yale-blue hover:bg-blue-800 text-white font-bold py-3 px-4 rounded-lg transition-colors">Submit Code</button>
                    <button id="p1-hint-button" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">Request Hint</button>
                </div>
                <p id="p1-hint-text" class="hidden mt-3 text-sm text-yellow-700 bg-yellow-100 p-2 rounded">
                    Hint: The code consists of the first letter of each correct answer, in order.
                </p>
                <p id="p1-final-feedback" class="feedback-message mt-2 text-center"></p>
            </div>
            
            <!-- New post-completion area for interactive clue discovery -->
            <div id="p1-post-completion-area" class="hidden mt-6">
                <p class="text-center">Database accessed! Now, locate the critical research notes for the final challenge.</p>
                <div class="flex justify-center mt-4">
                    <button id="p1-find-clue-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                        </svg>
                        Find Research Notes
                    </button>
                </div>
                <div id="p1-revealed-clue" class="mt-4 p-3 bg-yellow-50 border border-yellow-300 rounded-lg hidden">
                    <h3 class="font-bold text-yellow-800">Clue for Final Challenge:</h3>
                    <p class="text-yellow-700">"When consent forms have issues, remember that patient protection comes first. Always verify the documentation timeline!"</p>
                    <button id="p1-continue-button" class="mt-4 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">Continue to Protocol Matchup</button>
                </div>
            </div>
        </div>

        <div id="puzzle2-protocol" class="puzzle-container hidden">
            <h2 class="text-2xl font-semibold yale-blue-text mb-4">Puzzle 2: Protocol Matchup</h2>
            <p class="mb-4">Match the patient symptoms to the correct clinical trial protocols. Click a symptom tile, then click the corresponding protocol tile.</p>
            <div class="flex flex-col md:flex-row justify-between items-start">
                <div id="p2-symptoms-column" class="w-full md:w-5/12 mb-4 md:mb-0">
                    <h3 class="text-lg font-medium yale-blue-text mb-2 text-center">Symptoms</h3>
                    </div>
                <div class="w-full md:w-2/12 flex justify-center items-center text-2xl yale-blue-text font-bold">&rarr;</div>
                <div id="p2-protocols-column" class="w-full md:w-5/12">
                    <h3 class="text-lg font-medium yale-blue-text mb-2 text-center">Protocols</h3>
                    </div>
            </div>
             <div id="p2-feedback" class="feedback-message mt-6 text-center"></div>
            <button id="p2-next-puzzle" class="hidden mt-6 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">Proceed to Data Dilemma</button>
            
            <!-- New post-completion area for interactive clue discovery -->
            <div id="p2-post-completion-area" class="hidden mt-6">
                <p class="text-center">Protocol matchups confirmed! A storage cabinet appears to contain additional information.</p>
                <div class="flex justify-center mt-4">
                    <button id="p2-find-clue-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd" />
                        </svg>
                        Open Storage Cabinet
                    </button>
                </div>
                <div id="p2-revealed-clue" class="mt-4 p-3 bg-yellow-50 border border-yellow-300 rounded-lg hidden">
                    <h3 class="font-bold text-yellow-800">Clue for Final Challenge:</h3>
                    <p class="text-yellow-700">"When temperature controls fail for investigational products, immediate quarantine and assessment is the only safe approach."</p>
                    <button id="p2-continue-button" class="mt-4 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">Continue to Data Dilemma</button>
                </div>
            </div>
        </div>

        <div id="puzzle3-data" class="puzzle-container hidden">
            <h2 class="text-2xl font-semibold yale-blue-text mb-4">Puzzle 3: Data Dilemma</h2>
            <p class="mb-4">Answer the following questions related to data queries and EHR navigation. Select the best answer for each.</p>
            <div id="p3-questions-container">
                </div>
            <div id="p3-feedback-overall" class="feedback-message mt-4 text-center"></div>
            <button id="p3-submit-answers" class="mt-6 w-full yale-blue hover:bg-blue-800 text-white font-bold py-3 px-4 rounded-lg transition-colors">Check Answers</button>
            <button id="p3-next-puzzle" class="hidden mt-6 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">Continue to Locked Storage</button>
            
            <!-- New post-completion area for interactive clue discovery -->
            <div id="p3-post-completion-area" class="hidden mt-6">
                <p class="text-center">Data queries resolved! A notification appears on the computer screen: "You have 1 unread message."</p>
                <div class="flex justify-center mt-4">
                    <button id="p3-find-clue-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                            <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
                        </svg>
                        Check Message
                    </button>
                </div>
                <div id="p3-revealed-clue" class="mt-4 p-3 bg-yellow-50 border border-yellow-300 rounded-lg hidden">
                    <h3 class="font-bold text-yellow-800">Clue for Final Challenge:</h3>
                    <p class="text-yellow-700">"When medication errors occur, patient assessment and safety must always be prioritized over documentation or reporting."</p>
                    <button id="p3-continue-button" class="mt-4 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">Continue to Locked Storage</button>
                </div>
            </div>
        </div>

        <div id="puzzle4-storage" class="puzzle-container hidden">
            <h2 class="text-2xl font-semibold yale-blue-text mb-4">Puzzle 4: Locked Storage</h2>
            <p class="mb-4">Test your knowledge of GCP, FDA guidelines, and best practices for storing sensitive research information.</p>
             <div id="p4-questions-container">
                </div>
            <div id="p4-feedback-overall" class="feedback-message mt-4 text-center"></div>
            <button id="p4-submit-answers" class="mt-6 w-full yale-blue hover:bg-blue-800 text-white font-bold py-3 px-4 rounded-lg transition-colors">Verify Storage Protocols</p>
            <button id="p4-next-puzzle" class="hidden mt-6 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">Initiate Emergency Response</button>
            
            <!-- New post-completion area for interactive clue discovery -->
            <div id="p4-post-completion-area" class="hidden mt-6">
                <p class="text-center">Storage protocols verified! You notice a security panel with a blinking red light indicating a system alert.</p>
                <div class="flex justify-center mt-4">
                    <button id="p4-find-clue-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M18 8a6 6 0 01-7.743 5.743L10 14l-1 1-1 1H6v-1l1-1 1-1-.257-.257A6 6 0 1118 8zm-6-4a1 1 0 10-2 0v2a1 1 0 102 0V4zm-5 8a1 1 0 00-2 0v2a1 1 0 102 0v-2z" clip-rule="evenodd" />
                        </svg>
                        Check Security Alert
                    </button>
                </div>
                <div id="p4-revealed-clue" class="mt-4 p-3 bg-yellow-50 border border-yellow-300 rounded-lg hidden">
                    <h3 class="font-bold text-yellow-800">Clue for Final Challenge:</h3>
                    <p class="text-yellow-700">"When data breaches occur, containment and prompt notification to officials are essential first steps to protect participant privacy."</p>
                    <button id="p4-continue-button" class="mt-4 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">Continue to Emergency Response</button>
                </div>
            </div>
        </div>

        <div id="puzzle5-limericks" class="puzzle-container hidden">
            <h2 class="text-2xl font-semibold yale-blue-text mb-2">Final Challenge: Timed Emergency Response!</h2>
            <p class="yale-gray-text mb-4">Anomalies detected! Solve the limerick puzzles to identify critical actions. You have <span id="p5-timer" class="font-bold text-red-600">8:00</span> minutes.</p>
            <div id="p5-limericks-container">
                </div>
            <button id="p5-submit-escape" class="mt-6 w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition-colors">Attempt Final Escape!</button>
            <div id="p5-feedback" class="feedback-message mt-4 text-center"></div>
        </div>
        
        <div id="success-section" class="puzzle-container hidden text-center">
            <h2 class="text-3xl font-bold text-green-600 mb-4">Congratulations, Yale Researchers!</h2>
            <img src="https://placehold.co/120x120/22c55e/ffffff?text=SUCCESS!" alt="Success" class="mx-auto mb-4 rounded-full">
            <p class="text-xl mb-4">You have successfully navigated all the challenges and proven your expertise!</p>
            <p class="mb-6">The Decker Protein clinical trial is now cleared for launch, thanks to your dedication and sharp thinking. You've demonstrated exceptional knowledge of clinical trial protocols and problem-solving skills.</p>
            <p class="yale-gray-text">Well done!</p>
        </div>

        <div id="failure-section" class="puzzle-container hidden text-center">
            <h2 class="text-3xl font-bold text-red-600 mb-4">You have been issued an FDA Form 483!</h2>
            <img src="https://placehold.co/120x120/ef4444/ffffff?text=FORM 483" alt="Failure" class="mx-auto mb-4 rounded-full">
            <p class="text-xl mb-4">Time expired before critical actions could be taken!</p>
            <p class="mb-6">The Decker Protein clinical trial has been cited for deficiencies in emergency response protocols. The FDA has issued observations that must be addressed before the trial can proceed.</p>
            <button id="restart-game-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md transition-transform transform hover:scale-105">
                Restart Challenge
            </button>
        </div>

        <div id="survey-section" class="puzzle-container hidden">
            <h2 class="text-2xl font-semibold yale-blue-text mb-4">Your Feedback Matters!</h2>
            <p class="mb-6">Thank you for completing the Decker Protein Challenge! Please take a moment to fill out our brief survey:</p>
            
            <div class="flex justify-center mb-4">
                <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSeH2SFiYq4UgyxRJRZz6oJcx5rbWtzoqF38Ec1w_Z8z5bJ2jQ/viewform?embedded=true" width="100%" height="800" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>
            </div>
        </div>

    </div>

<script src="script.js"></script>
</body>
</html>
